package JDBC;

import java.sql.*;

public class DBConnect {
	public static void main(String[] args) {
		
	      Object[][] patients = {
	              {"Anshita", 22, "Cold", "2025-08-01", "Dr. Mehra"},
	              {"Shri", 24, "Fever", "2025-08-01", "Dr. Ramesh"},
	              {"Dipanwita", 21, "Headache", "2025-08-01", "Dr. Mehra"},
	              {"Ajay", 22, "Cough", "2025-08-02", "Dr. Sen"}
	          };

		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			Connection con = DriverManager.getConnection("jdbc:mysql://localhost:3306/Hospital", "root", "anshi@12");

			String createTable = "CREATE TABLE IF NOT EXISTS patient (" + "id INT AUTO_INCREMENT PRIMARY KEY, "
					+ "name VARCHAR(50), "
					+ "age INT, "
					+ "disease VARCHAR(50), "
					+ "admission_date DATE, "
					+ "doctor_assigned VARCHAR(50))";
			Statement stmt = con.createStatement();
			stmt.executeUpdate(createTable); 
			System.out.println("Table 'patient' is created.\n");
		
			  String insertSql = "INSERT INTO patient(name, age, disease, admission_date, doctor_assigned) VALUES (?, ?, ?, ?, ?)";
	            PreparedStatement insertStmt = con.prepareStatement(insertSql);
	            for (Object[] patient : patients) {
	                insertStmt.setString(1, (String) patient[0]); 
	                insertStmt.setInt(2, (Integer) patient[1]);  
	                insertStmt.setString(3, (String) patient[2]);
	                insertStmt.setDate(4, Date.valueOf((String) patient[3])); 
	                insertStmt.setString(5, (String) patient[4]); 
	                insertStmt.executeUpdate();
	            }
	            System.out.println("All patient records inserted successfully.\n");

//			String deleteSql = "DELETE FROM patient WHERE name = ?";
//			PreparedStatement deleteStmt = con.prepareStatement(deleteSql);
//			deleteStmt.setString(1, "Rahul");
//
//			int rowsAffected = deleteStmt.executeUpdate();
//
//			if (rowsAffected > 0) {
//				System.out.println("Patient deleted successfully.");
//			} else {
//				System.out.println("No patient found with the given name.");
//			}
//
//			String updateSql = "UPDATE patient SET disease = ? WHERE name = ?";
//			PreparedStatement updateStmt = con.prepareStatement(updateSql);
//			updateStmt.setString(1, "Recovered");
//			updateStmt.setString(2, "Anshita");
//			int updateCount = updateStmt.executeUpdate();
//			if (updateCount > 0) {
//				System.out.println("Patient record updated successfully.");
//			} else {
//				System.out.println("No patient found to update.");
//			}

			con.close();

		} catch (Exception e) {
			e.printStackTrace();
		}
	}
}
